<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>FTP_4_29_2021</bpr:name>
    <bpr:release-notes />
    <bpr:created>2021-04-29 17:55:19Z</bpr:created>
    <bpr:package-id>31</bpr:package-id>
    <bpr:package-name>FTP</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="2">
        <object id="e6bc140b-c803-400e-aab0-f17f6210763f" name="FTP" xmlns="http://www.blueprism.co.uk/product/process"><process name="FTP" version="1.0" bpversion="7.0.0.35305" narrative="" byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>8b51840d-6051-41dd-be5e-cd840069da25</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="2fc5cbe3-31d2-4e39-b76a-881482c85dc8" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3280f71e-92bf-4b45-8815-54594ada7fee" type="Normal" published="True"><name>FTP Put</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="b871653e-c076-4f47-bc94-34c25bfd03aa" type="Normal" published="True"><name>SFTP Put</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2e3abc32-3a5a-4ed1-8601-d2925570e84b" type="Normal" published="True"><name>SFTP Put with rsa 2048</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="1372f9fc-fcd8-4e3e-ae95-736faefc8ee2" type="Normal" published="True"><name>SFTP Get</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ce9938d8-5dd1-4800-97f4-c5d70cc82afb" type="Normal" published="True"><name>SFTP Get with rsa 2048</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="003d5ee2-81f5-4504-90a1-37a287ec54b1" type="Normal" published="True"><name>SFTP Verify</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a1086c84-4fa4-4784-8873-10e5c6a5f5e1" type="Normal" published="True"><name>SFTP Verify with rsa 2048</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9db9c09f-177c-4539-a566-db4496fb3e5a" type="Normal" published="True"><name>FTP Verify</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="029dcfb3-8d43-4ade-b9d9-95ee46625ed0" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>cd69842a-6788-4cd6-a706-4ab573a22fe6</onsuccess></stage><stage stageid="cd69842a-6788-4cd6-a706-4ab573a22fe6" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="4b1727ec-88d3-4b23-b6f6-94b2a2c87510" name="Stage1" type="ProcessInfo"><display x="-195" y="-105" w="150" h="90" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>Microsoft.VisualBasic.dll</reference><reference>System.dll</reference><reference>"c:\bp\Renci.SshNet.dll"</reference><reference>"c:\bp\WinSCPnet.dll"</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import><import>System.Collections.Generic</import><import>System.Text</import><import>Microsoft.VisualBasic</import><import>Microsoft.VisualBasic.FileIO</import><import>System.Net</import><import>System.IO</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[]]></code></stage><stage stageid="88b1cf28-61bb-4107-9e06-e2d0db80b4e3" name="Clean Up" type="SubSheetInfo"><subsheetid>2fc5cbe3-31d2-4e39-b76a-881482c85dc8</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="1a4aacf1-109a-48f5-8c21-dba67eff1165" name="Start" type="Start"><subsheetid>2fc5cbe3-31d2-4e39-b76a-881482c85dc8</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>627fb996-4d2d-402b-b2ec-3e973502cca3</onsuccess></stage><stage stageid="627fb996-4d2d-402b-b2ec-3e973502cca3" name="End" type="End"><subsheetid>2fc5cbe3-31d2-4e39-b76a-881482c85dc8</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="71ee8f15-f0b8-496f-996b-4c87e0be41a1" name="FTP Put" type="SubSheetInfo"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><narrative>Puts a file using unsecure FTP</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="8226face-09f6-4631-b39d-61b35075136d" name="Start" type="Start"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="sourceFile" narrative="File to place" stage="sourceFile" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /></inputs><onsuccess>7d802272-0d4c-43d7-8a30-9e1f01e3fd0d</onsuccess></stage><stage stageid="13cf7aaa-6140-48f4-990f-980606758c3f" name="End" type="End"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><loginhibit /><display x="15" y="15" /></stage><stage stageid="cdb17a78-2886-4031-9f2e-a1e8ac30d98d" name="Note1" type="Note"><subsheetid>2fc5cbe3-31d2-4e39-b76a-881482c85dc8</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="6dcb34a1-b972-4a50-adab-857f619cf420" name="Note2" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="7d802272-0d4c-43d7-8a30-9e1f01e3fd0d" name="PushToFTP" type="Code"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="FTPTargetFile" expr="[targetFile]" /><input type="text" name="sourceFile" expr="[sourceFile]" /></inputs><onsuccess>13cf7aaa-6140-48f4-990f-980606758c3f</onsuccess><code><![CDATA[Dim clsRequest As System.Net.FtpWebRequest = _
    DirectCast(WebRequest.Create(FTPTargetFile), FtpWebRequest)
clsRequest.Credentials = New NetworkCredential(FTPUsername, FTPPassword)
clsRequest.Method = WebRequestMethods.Ftp.UploadFile

' read in file...
Dim bFile() As Byte = System.IO.File.ReadAllBytes(sourceFile)

' upload file...
Dim clsStream As System.IO.Stream = _
    clsRequest.GetRequestStream()
clsStream.Write(bFile, 0, bFile.Length)
clsStream.Close()
clsStream.Dispose()]]></code></stage><stage stageid="4a315418-dc36-4d42-bc9a-c747efdb4e8d" name="FTPDir" type="Data"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="07db4fb7-9661-492f-aa44-9ab09d9a61cd" name="FTPServer" type="Data"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cc99d10b-b5a7-4b5d-9a56-87e9aa1cc74a" name="FTPPassword" type="Data"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="714b045d-c2c6-419c-8b77-650e02b9a77f" name="FTPUsername" type="Data"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="02c90717-6ca1-4a8e-8258-ff2e7670200c" name="sourceFile" type="Data"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4fc47d53-759a-4721-83a1-b77f7e678c07" name="targetFile" type="Data"><subsheetid>3280f71e-92bf-4b45-8815-54594ada7fee</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ea2e7abf-20f2-4393-a37e-a757538c3907" name="FTP Verify" type="SubSheetInfo"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><narrative>Verifies a file exists on an unsecured FTP</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="33ac6741-7dfe-4303-98d5-c1f8d27db8e7" name="Start" type="Start"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /></inputs><onsuccess>3204a6d0-ab5f-4578-8b97-ecda8d1aa9f5</onsuccess></stage><stage stageid="98abd13b-e706-4be2-a87e-89e3caf69c5b" name="End" type="End"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><loginhibit /><display x="15" y="15" /></stage><stage stageid="6b02aaf5-87ce-48b2-b755-0e1c9e4ef52e" name="FTPDir" type="Data"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8203c232-90e4-4b27-809d-1c1848d43e07" name="FTPServer" type="Data"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8b72d41e-37ef-46b5-b4aa-5d7839388244" name="FTPPassword" type="Data"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="da862f0d-7645-4808-b5b7-024000337ed7" name="FTPUsername" type="Data"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc25eaef-80fe-45d0-ba03-4e05f5fd9cf2" name="sourceFile" type="Data"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d5830dd7-b5f4-47b6-bcab-b4a6fb9ec788" name="targetFile" type="Data"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="30f8e579-a865-4645-a464-0ff1bb1a1d18" name="Files" type="Collection"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><display x="90" y="-45" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="3204a6d0-ab5f-4578-8b97-ecda8d1aa9f5" name="VerifyFTP" type="Code"><subsheetid>9db9c09f-177c-4539-a566-db4496fb3e5a</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="FTPTargetFile" expr="[targetFile]" /></inputs><outputs><output type="collection" name="Files" stage="Files" /></outputs><onsuccess>98abd13b-e706-4be2-a87e-89e3caf69c5b</onsuccess><code><![CDATA[Dim clsRequest As System.Net.FtpWebRequest = _
    DirectCast(WebRequest.Create(FTPTargetFile), FtpWebRequest)
clsRequest.Credentials = New NetworkCredential(FTPUsername, FTPPassword)
clsRequest.Method = WebRequestMethods.Ftp.ListDirectory

Dim reader As New StreamReader(clsRequest.GetResponse().GetResponseStream())
Dim line = reader.ReadLine()
Dim lines As New DataTable

lines.Columns.Add("fileName")

Do Until line Is Nothing
	lines.Rows.Add(line)
	line=reader.ReadLine()
Loop

Files = lines]]></code></stage><stage stageid="21fa5e08-695a-4a62-8ec6-4b2f0dcb2145" name="SFTP Put" type="SubSheetInfo"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><narrative>Puts a file using SFTP</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="0abc0971-5dff-4d24-9247-a8fbd0d583db" name="Start" type="Start"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="sourceFile" narrative="File to place" stage="sourceFile" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /></inputs><onsuccess>62a75b1f-95bc-49ae-a23a-b1face44ab2d</onsuccess></stage><stage stageid="39f815e3-a86b-48e0-a964-5e5f766fda2c" name="End" type="End"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><loginhibit /><display x="15" y="15" /></stage><stage stageid="62a75b1f-95bc-49ae-a23a-b1face44ab2d" name="PushToSFTP" type="Code"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="FTPTargetFile" expr="[targetFile]" /><input type="text" name="sourceFile" expr="[sourceFile]" /></inputs><onsuccess>39f815e3-a86b-48e0-a964-5e5f766fda2c</onsuccess><code><![CDATA[Dim client as Sftpclient = New SftpClinent(FTPServer,FTPUsername,FTPPassword)
client.Connect()

Using stream as Stream = File.OpenRead(sourceFile)
	client.UploadFile(stream,FTPTargetFile)
End Using]]></code></stage><stage stageid="10fe10cb-f809-4ad9-9516-b502fde29929" name="FTPDir" type="Data"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bb97688c-dcc3-484e-9122-aa3d06485350" name="FTPServer" type="Data"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="432bff2d-5393-4652-a67c-2f5dc7c13a4e" name="FTPPassword" type="Data"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="e111effa-6946-4fe8-9da8-39e00bb7dcf5" name="FTPUsername" type="Data"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1e720313-3e1c-488b-9dc4-29208ddd7da7" name="sourceFile" type="Data"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9e027b02-3bc9-4db1-a286-0ce3d8a6b1d0" name="targetFile" type="Data"><subsheetid>b871653e-c076-4f47-bc94-34c25bfd03aa</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ea82b3c9-b43e-4327-82e3-9d4e2a13e062" name="SFTP Get" type="SubSheetInfo"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><narrative>Gets a file using SFTP</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="6ea6c0f2-0cf2-47bc-b027-6d0071936a0e" name="Start" type="Start"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="sourceFile" narrative="File to place" stage="sourceFile" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /></inputs><onsuccess>1fff304d-a59e-4556-a188-028acbc2b19b</onsuccess></stage><stage stageid="2f5b0024-9317-4234-95bd-f5ac1a17059f" name="End" type="End"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><loginhibit /><display x="15" y="15" /></stage><stage stageid="1fff304d-a59e-4556-a188-028acbc2b19b" name="GetFromSFTP" type="Code"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="TargetFile" expr="[targetFile]" /><input type="text" name="FTPsourceFile" expr="[sourceFile]" /></inputs><onsuccess>2f5b0024-9317-4234-95bd-f5ac1a17059f</onsuccess><code><![CDATA[Dim client as Sftpclient = New SftpClinent(FTPServer,FTPUsername,FTPPassword)
client.Connect()

Using stream as Stream = File.OpenRead(FTPSourceFile)
	client.DownloadFile(stream,TargetFile)
End Using]]></code></stage><stage stageid="cb29e2f0-969f-41e7-b0c5-404d75cd7019" name="FTPDir" type="Data"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bb064f21-d20f-4e51-b51a-2e6cddc8788a" name="FTPServer" type="Data"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c0dcd718-d9d6-424a-bde0-e80514ece12c" name="FTPPassword" type="Data"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="8b616b4c-ad40-4316-ae85-9fb23d6b3eef" name="FTPUsername" type="Data"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8eebdc35-62ce-4f72-a7c3-6e3fab9436d6" name="sourceFile" type="Data"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0e41bd22-4fb7-406c-8526-7a6e4f685746" name="targetFile" type="Data"><subsheetid>1372f9fc-fcd8-4e3e-ae95-736faefc8ee2</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d273c2c2-4427-4e99-8a1d-fe0bb7037544" name="SFTP Verify" type="SubSheetInfo"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><narrative>Gets a list of files in a directory using SFTP</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="97702eb5-bc15-40a4-927e-a2e812d855df" name="Start" type="Start"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /></inputs><onsuccess>eba18e32-e3d5-40bf-88c3-fc091f541313</onsuccess></stage><stage stageid="ccd7a38f-a05a-457b-b371-ba79f1bbb188" name="End" type="End"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><loginhibit /><display x="15" y="15" /><outputs><output type="collection" name="Files" narrative="List of files in directory" stage="Files" /></outputs></stage><stage stageid="eba18e32-e3d5-40bf-88c3-fc091f541313" name="VerifyFromSFTP" type="Code"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="TargetFile" expr="[targetFile]" /></inputs><outputs><output type="collection" name="Files" stage="Files" /></outputs><onsuccess>ccd7a38f-a05a-457b-b371-ba79f1bbb188</onsuccess><code><![CDATA[Dim client as Sftpclient = New SftpClinent(FTPServer,FTPUsername,FTPPassword)
client.Connect()

Dim fileList As List(Of SftpFile> = sftpClient.ListDirectory(FTPSourceFile).ToList()

Dim lines As New DataTable
lines.Columns.Add("fileName")

if fileList <> null and fileList.Count() > 2 then
	dim i as int = 2
	while i < fileLast.Count()
		lines.Rows.Add(fileList(i))
		i = i+1
	end while
end if

client.Disconnect()
Files = lines]]></code></stage><stage stageid="2f284b07-b9e4-404f-98d9-ba22e7709bab" name="FTPDir" type="Data"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="08b4f60e-4aa7-47d3-8197-8517037874d8" name="FTPServer" type="Data"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5ab16b8b-7267-4224-b0a3-b2a91458bb38" name="FTPPassword" type="Data"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="5f5d86be-7393-48a0-92b5-dbc917a78d1a" name="FTPUsername" type="Data"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bc1fa2f0-d5a0-4cf7-b914-3a37c2cb35f2" name="sourceFile" type="Data"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cb2bad56-8f43-4d4e-a00a-4f95cd9fd31a" name="targetFile" type="Data"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4bec725a-c7f2-4cda-a0c1-eb7ce4c024ff" name="SFTP Put with rsa 2048" type="SubSheetInfo"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><narrative>Puts a file using SFTP with an rsa 2048 host key</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="15213dc3-dbe6-477c-9b1e-04210155a1b0" name="Start" type="Start"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="sourceFile" narrative="File to place" stage="sourceFile" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /><input type="text" name="hostkey" narrative="RSA-2048 format" stage="hostkey" /></inputs><onsuccess>72561729-7ed6-4777-9101-60aaeb221cc3</onsuccess></stage><stage stageid="b1cc5a26-e663-4579-a684-fd5784c90a51" name="End" type="End"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><loginhibit /><display x="15" y="15" /></stage><stage stageid="72561729-7ed6-4777-9101-60aaeb221cc3" name="PushToSFTP_2048" type="Code"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="FTPTargetFile" expr="[targetFile]" /><input type="text" name="sourceFile" expr="[sourceFile]" /><input type="text" name="hostkey" expr="[hostkey]" /></inputs><onsuccess>b1cc5a26-e663-4579-a684-fd5784c90a51</onsuccess><code><![CDATA[Dim sessionOptions As New SessionOptions
With sessionOptions
	.Protocol = Protocol.sftp
	.HostName = FTPServer
	.UserName = FTPUsername
	.Password = FTPPassword
	.SshHostKeyFingerprint = "ssh-rsa "+hostKey
End With

Using session As New Session
	session.Open(sessionOptions)

	session.PutFiles(sourceFile, FTPTargetFile).Check()
End Using]]></code></stage><stage stageid="421fe50e-16a5-4f37-b796-4c1f1144e0ae" name="FTPDir" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3f5ee1b1-05e8-4f49-93f1-0b23f208eb32" name="FTPServer" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f1c2d619-46bc-4564-bf45-df31792d412b" name="FTPPassword" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="e1832f96-57f4-45ac-8434-99db8a90fa37" name="FTPUsername" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2944fab5-3cea-47c6-89f1-912d6f86dfc5" name="sourceFile" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="25450eb9-b629-4461-a03e-aaf273989dfa" name="targetFile" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="804cab14-6b5e-43c0-8e49-695a975d1486" name="hostkey" type="Data"><subsheetid>2e3abc32-3a5a-4ed1-8601-d2925570e84b</subsheetid><display x="-60" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2503b562-1d89-446d-8438-3974d0909969" name="SFTP Get with rsa 2048" type="SubSheetInfo"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><narrative>Gets a file using SFTP with an rsa 2048 host key</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="a0194119-bb10-46cc-894b-1c15a96dc735" name="Start" type="Start"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="sourceFile" narrative="File to place" stage="sourceFile" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /><input type="text" name="hostkey" narrative="RSA-2048 format" stage="hostkey" /></inputs><onsuccess>abae99c6-5de7-47e7-8043-b07d27b4f76a</onsuccess></stage><stage stageid="81829b79-f511-4aea-9ce4-422150302632" name="End" type="End"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><loginhibit /><display x="15" y="15" /></stage><stage stageid="abae99c6-5de7-47e7-8043-b07d27b4f76a" name="GetFromSFTP_2048" type="Code"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="FTPTargetFile" expr="[targetFile]" /><input type="text" name="sourceFile" expr="[sourceFile]" /><input type="text" name="hostkey" expr="[hostkey]" /></inputs><onsuccess>81829b79-f511-4aea-9ce4-422150302632</onsuccess><code><![CDATA[Dim sessionOptions As New SessionOptions
With sessionOptions
	.Protocol = Protocol.sftp
	.HostName = FTPServer
	.UserName = FTPUsername
	.Password = FTPPassword
	.SshHostKeyFingerprint = "ssh-rsa "+hostKey
End With

Using session As New Session
	session.Open(sessionOptions)
	
	Dim transferOptions as New TransferOptions
	transferOptions.transferMode = TransferMode.Binary

	Dim transferResult As New TransferOperationResult
	transferResult = session.GetFiles(sourceFile, FTPTargetFile, false, TransferOptions).Check()
End Using]]></code></stage><stage stageid="02cf19d5-3080-44e8-951e-e1f2d1432a39" name="FTPDir" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="955e0534-8427-4404-989f-d1718ef3a9ba" name="FTPServer" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6f843846-55bc-4363-8ef3-1fc403d42b4a" name="FTPPassword" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="17c0b220-7f40-4d94-988a-6a9ea282b1ef" name="FTPUsername" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d5e90b38-dc00-40f6-b62b-2ff2895ed3d4" name="sourceFile" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="76e11445-9994-457e-aa54-88ee48b63bb1" name="targetFile" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e2dc8b59-ff6a-44af-81b1-cc7cd511d84f" name="hostkey" type="Data"><subsheetid>ce9938d8-5dd1-4800-97f4-c5d70cc82afb</subsheetid><display x="-60" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f3388893-836c-44dc-a925-4e66b3874771" name="Files" type="Collection"><subsheetid>003d5ee2-81f5-4504-90a1-37a287ec54b1</subsheetid><display x="90" y="-45" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="453ba4cb-a548-4b97-ba96-a4d2187ab499" name="SFTP Verify with rsa 2048" type="SubSheetInfo"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><narrative>Gets a list of files in a directory using SFTP with an rsa 2048 host key</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="c390b744-7280-4951-9a7d-0355762ac96c" name="Start" type="Start"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="FTPDir" narrative="Directory in the FTP Server" stage="FTPDir" /><input type="text" name="FTPServer" narrative="Server address" stage="FTPServer" /><input type="password" name="FTPPassword" narrative="Password" stage="FTPPassword" /><input type="text" name="FTPUsername" narrative="Username" stage="FTPUsername" /><input type="text" name="targetFile" narrative="Target file location and name" stage="targetFile" /></inputs><onsuccess>a8b41737-de31-4641-893b-6ac2844d8de7</onsuccess></stage><stage stageid="1f3349ce-3412-40d2-9953-941348730971" name="End" type="End"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><loginhibit /><display x="15" y="15" /><outputs><output type="collection" name="Files" narrative="List of files in directory" stage="Files" /></outputs></stage><stage stageid="a8b41737-de31-4641-893b-6ac2844d8de7" name="VerifyFromSFTP_2048" type="Code"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="FTPDir" expr="[FTPDir]" /><input type="text" name="FTPServer" expr="[FTPServer]" /><input type="password" name="FTPPassword" expr="[FTPPassword]" /><input type="text" name="FTPUsername" expr="[FTPUsername]" /><input type="text" name="TargetFile" expr="[targetFile]" /></inputs><outputs><output type="collection" name="Files" stage="Files" /></outputs><onsuccess>1f3349ce-3412-40d2-9953-941348730971</onsuccess><code><![CDATA[Dim sessionOptions As New SessionOptions
With sessionOptions
	.Protocol = Protocol.sftp
	.HostName = FTPServer
	.UserName = FTPUsername
	.Password = FTPPassword
	.SshHostKeyFingerprint = "ssh-rsa "+hostKey
End With

Using session As New Session
	session.Open(sessionOptions)
	
	Dim directory as RemoteDirectoryInfo = session.ListDirectory(TargetFile)
	Dim fileInfo as RemoteFileInfo
	Dim lines As New DataTable
	lines.Columns.Add("fileName")

	for each fileInfo in directory.Files
		lines.Rows.Add(fileInfo.Name)
	next
end Using

Files = lines]]></code></stage><stage stageid="143dca58-caab-499d-9bbb-2f5ea69e34b5" name="FTPDir" type="Data"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="135" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4da4da76-8cab-45d3-af70-070979973d4f" name="FTPServer" type="Data"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="90" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="afb4cb15-c8ee-4e54-b252-dd756bb2e25a" name="FTPPassword" type="Data"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="225" y="-105" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="424b9b87-6870-47b3-9e30-532bed4347f9" name="FTPUsername" type="Data"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="180" y="-105" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1e8341ff-c1e8-460f-908e-21cdabf8ebdf" name="sourceFile" type="Data"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="120" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0b9a1f17-7871-438a-b293-61f88ca052bb" name="targetFile" type="Data"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="165" y="-75" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b4c32401-044b-4123-ae86-655f4a209eb2" name="Files" type="Collection"><subsheetid>a1086c84-4fa4-4784-8873-10e5c6a5f5e1</subsheetid><display x="90" y="-45" /><datatype>collection</datatype><private /><alwaysinit /></stage></process></object>
        <object-group id="be68aafc-7ce6-43de-810e-7f194e000a0a" name="Utility Objects" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="e6bc140b-c803-400e-aab0-f17f6210763f" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>